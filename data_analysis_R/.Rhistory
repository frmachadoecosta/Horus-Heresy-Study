geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(Caschool$testscr, probs = 0.8),
xmax = quantile(Caschool$testscr, probs=1),ymin=0,
ymax=45, alpha=.2, fill="red")
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.8),
xmax = quantile(WH40k$average_rating, probs=1),ymin=0,
ymax=45, alpha=.2, fill="red")
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.8),
xmax = quantile(WH40k$average_rating, probs=1),ymin=0,
ymax=20, alpha=.2, fill="red")
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.8),
xmax = quantile(WH40k$average_rating, probs=1),ymin=0,
ymax=15, alpha=.2, fill="red")
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.8),
xmax = quantile(WH40k$average_rating, probs=1),ymin=0,
ymax=17, alpha=.2, fill="red")
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.8),
xmax = quantile(WH40k$average_rating, probs=1), alpha=.2, fill="red")
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.8),
xmax = quantile(WH40k$average_rating, probs=1),ymin=0,
ymax=18, alpha=.2, fill="red")
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.8),
xmax = quantile(WH40k$average_rating, probs=10),ymin=0,
ymax=18, alpha=.2, fill="red")
ggplot(WH40k, aes(x=average_rating)) +
ggplot(WH40k, aes(x=average_rating)) +
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.8),
xmax = max(WH40k$average_rating),ymin=0,
ymax=18, alpha=.2, fill="red")
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.8),
xmax =4.5,ymin=0,
ymax=18, alpha=.2, fill="red")
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.5,ymin=0,
ymax=18, alpha=.2, fill="red")
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.5,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15),size=4) +
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.5,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15),size=4)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.5,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 1), label="What I'm reading", y=15),size=4)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.5,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= 0.5,size=4)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.5,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= 1,size=4)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.5,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -1,size=4)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.5,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.5,size=4)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.5,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.7,size=4)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.5,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=4)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.5,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=5)
setwd("E:/R_Projects/Goodreads")
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =quantile(WH40k$average_rating, probs = 1),ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=5)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =max(WH40k$average_rating),ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=5)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.3,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=5)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.4,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=5)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.45,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=5)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.49,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=5)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.445,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=5)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.455,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=5)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.45,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=5)
WH40k$title[WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9) ]
selected <- WH40k$title[WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9) ]
WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9)
WH40k[WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9)]
WH40k[,WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9)]
selected <- WH40k$title[ which( WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9)) ]
selected <- WH40k$title[ which(WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9)) ]
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.45,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=5)
selected <- WH40k[which(WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9)) ]
which(WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9))
WH40k[which(WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9)), "title"]
WH40k[which(WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9))]
WH40k[which(WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9)), "title"]
sel <- WH40k[which(WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9)), "title"]
sel.names
sel
WH40k[1 12 14 19 24 39 41 49 63 79]
WH40k[c(1, 12, 14, 19, 24, 39, 41, 49, 63, 79)]
WH40k[c(1, 12, 14, 19, 24, 39, 41, 49, 63, 79),]
WH40k[c(1, 12, 14, 19, 24, 39, 41, 49, 63, 79),"title"]
WH40k[c(1, 12, 14, 19, 24, 39, 41, 49, 63, 79),]
selected <- WH40k[which(WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9)),]
selected$title
Warhammer_Books <- read.csv("E:/R_Projects/Goodreads/Warhammer_Books.csv")
View(Warhammer_Books)
selected <- WH40k[which(WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9)),'title']
#goodreads_dataset analysis
library(ggplot2)
WH40k <- read.csv('Warhammer_Books.csv')
View(WH40k)
View(WH40k)
str(WH40k)
#it's reading title and author as factor, should be character
WH40k$title <- as.character(WH40k$title)
WH40k$author <- as.character(WH40k$author)
View(WH40k)
summary(WH40k$average_rating)
hist(WH40k$average_rating,
breaks = 5,
main = 'Average Ratings of Horus Heresy Books',
xlab = 'Average Rating'
)
ggplot(WH40k, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=WH40k, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(WH40k$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(WH40k$average_rating, probs = 0.9),
xmax =4.45,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(WH40k$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=5)
selected <- WH40k[which(WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9)),'title']
selected
which(WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9))
selected <- WH40k[which(WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9)),]
selected
selected[order('publication_year')]
selected[order(-'publication_year')]
selected[order(publication_year)]
selected[order('publication_year')]
selected[order('publication_year'), "title"]
selected[order('publication_year'), "title"]
selected <- WH40k[which(WH40k$average_rating>=quantile(WH40k$average_rating, probs = 0.9)),]
selected[order('publication_year'), "title"]
selected
selected$title
ggplot(hhn, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=hhn, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(hhn$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(hhn$average_rating, probs = 0.9),
xmax =4.45,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(hhn$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=5)
#goodreads_dataset analysis
library(ggplot2)
hhn <- read.csv('Warhammer_Books.csv')
str(hhn)
#it's reading title and author as factor, should be character
hhn$title <- as.character(hhn$title)
hhn$author <- as.character(hhn$author)
summary(hhn$average_rating)
hist(hhn$average_rating,
breaks = 5,
main = 'Average Ratings of Horus Heresy Books',
xlab = 'Average Rating'
)
ggplot(hhn, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=hhn, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(hhn$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(hhn$average_rating, probs = 0.9),
xmax =4.45,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(hhn$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=5)
firstselected <- hhn[which(hhn$average_rating>=quantile(hhn$average_rating, probs = 0.9)),]
firstselected$title
hhn['author'=='Dan Abnett','title']
hhn[where ]
hhn[which ('ratings_count' >150), ]
plot(hhn$publication_year,hhn$average_rating)
max(hhn$average_rating)
#Second Analysis - being picky
#---------------------------------------------------------------------
# Deciding what I'm reading just based of user reviews is bad enough,
# I shouldn't consider books with ratings_count under 150
hhn.high <- hhn[hhn$ratings_count > 150 ,]
plotbygg <- function(dataset){
ggplot(hhn, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=hhn, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(hhn$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(hhn$average_rating, probs = 0.9),
xmax =4.45,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(hhn$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=5)
}
plotbygg()
ggplot(hhn.high, aes(x=average_rating)) +
geom_histogram(binwidth=0.1,color="darkblue", fill="lightblue") +
ggtitle("Average Ratings of Horus Heresy Books")+
theme(plot.title = element_text(hjust = 0.5))+
labs(y="Nº of Books", x = "Average Rating")+
geom_vline(data=hhn.high, aes(xintercept=mean(average_rating)),linetype="dashed")+
geom_text(aes(x=mean(hhn.high$average_rating), label="Mean of Ratings", y=15),angle=90,vjust=-0.5,size=4) +
annotate("rect",xmin=quantile(hhn.high$average_rating, probs = 0.9),
xmax =4.45,ymin=0,
ymax=18, alpha=.2, fill="red") +
geom_text(aes(x=quantile(hhn.high$average_rating, probs = 0.9), label="What I'm reading", y=15), hjust= -0.3,size=5)
secondselected <- hhn.high[which(hhn.high$average_rating>=quantile(hhn.high$average_rating, probs = 0.9)),]
secondselected$title
firstselected$title
#Third Analysis - fanboying
#---------------------------------------------------------------------
#Collect all Dan Abbet's writing with over 4.0 rating and ratings_count over 150
hhn.dan <- hnn[hhn$ratings_count > 150 & hhn$author== 'Dan Abnett',]
#Third Analysis - fanboying
#---------------------------------------------------------------------
#Collect all Dan Abbet's writing with over 4.0 rating and ratings_count over 150
hhn.dan <- hhn[hhn$ratings_count > 150 & hhn$author== 'Dan Abnett',]
hhn.dan$title
#Third Analysis - fanboying
#---------------------------------------------------------------------
#Collect all Dan Abbet's writing with over 4.0 rating and ratings_count over 150
hhn.dan <- hhn[hhn$ratings_count > 150 & hhn$author== 'Dan Abnett' & hhn$average_rating>4.0,]
hhn.dan$title
best <- rbind(firstselected,secondselected,hhn.dan)
best$title
best.clean <- dplyr::distinct(best)
best.clean
best.clean$title
firstselected$title
secondselected$title
best <- rbind(secondselected,hhn.dan)
best.clean <- dplyr::distinct(best)
best.clean$title
best.clean
secondselected$title
secondselected$average_rating
firstselected$title
best.clean[order('publication_year'),]
order(best.clean$publication_year)
best.clean[order(best.clean$publication_year),]
best.clean[order(best.clean$publication_year),'title']
toread <- best.clean[order(best.clean$publication_year),'title']
toread
write.csv(toread, 'finallist.csv')
write.csv(toread, 'finallist.csv', row.names = F, col.names = F)
colnames(toread) <- 'Books to Read'
to read
toread
write.csv(toread, 'final_list.csv', row.names = F)
write.csv(toread, 'final_list.csv', row.names = FALSE)
write.csv(toread, 'final_list.csv', row.names = FALSE)
write.table(toread, "final_list.csv", sep = ",", row.names = FALSE, col.names = FALSE)
